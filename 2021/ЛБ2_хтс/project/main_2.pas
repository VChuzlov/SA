uses UFlow, UMixer, UHeatExchanger, USplitter;

const
  f1_mass_frac: array of real = (9.75361395781172E-06, 0, 0.0975361395781172, 
    9.75361395781172E-06, 0.000975361395781172, 0.00975361395781172,
    0.00975361395781172, 0.000975361395781172, 9.75361395781172E-06,
    0.146304209367176, 9.75361395781172E-06, 0.146304209367176,
    0.000975361395781172, 9.75361395781172E-06, 0.000975361395781172,
    9.75361395781172E-05, 9.75361395781172E-05, 9.75361395781172E-06,
    0.195072279156234, 0.0487680697890586, 9.75361395781172E-07,
    0.292608418734352, 0.000975361395781172, 0.0487680697890586);
    
  f2_mass_frac: array of real = (7.46036160671122E-06, 0, 0.0746036160671122,
    7.46036160671122E-06, 0.000746036160671122, 0.00746036160671122,
    0.00746036160671122, 0.000746036160671122, 7.46036160671122E-06, 
    0.111905424100668, 7.46036160671122E-06, 0.111905424100668,
    0.000746036160671122, 7.46036160671122E-06, 0.000746036160671122,
    7.46036160671122E-05, 7.46036160671122E-05, 7.46036160671122E-06, 
    0.149207232134224, 0.0373018080335561, 7.46036160671122E-07, 
    0.458929068075501, 0.000746036160671122, 0.0373018080335561);  
  
  f3_mass_frac: array of real = (5.10041076668151E-06, 0, 0.0510041076668151,
    5.10041076668151E-06, 0.00051004107666815, 0.00510041076668151, 
    0.00510041076668151, 0.00051004107666815, 5.10041076668151E-06,
    0.0765061615002226, 5.10041076668151E-06, 0.0765061615002226, 
    0.00051004107666815, 5.10041076668151E-06, 0.00051004107666815,
    5.10041076668151E-05, 5.10041076668151E-05, 5.10041076668151E-06,
    0.261462612152932, 0.0255020538334075, 5.10041076668151E-07,
    0.470632701875278, 0.00051004107666815, 0.0255020538334075);
    
  f7_mass_frac: array of real  = (9.30006761149154E-06, 0, 0, 9.30006761149154E-06, 
    0.000930006761149154, 0.00930006761149154, 0.00930006761149154,
    0.000930006761149154, 9.30006761149154E-06, 0.465003380574577,
    9.30006761149154E-06, 0.232501690287288, 0.000930006761149154, 
    9.30006761149154E-06, 0.000930006761149154, 9.30006761149154E-05, 
    9.30006761149154E-05, 9.30006761149154E-06, 0, 0.232501690287288,
    9.30006761149154E-07, 0, 0.000930006761149154, 0.0465003380574577);
    
    
 procedure main(g: real);
 begin
   var f1 := new Flow(1000, f1_mass_frac, 298);
   var f2 := new Flow(g, f2_mass_frac, 320);
   var f3 := new Flow(1500, f3_mass_frac, 300);
   
   var f7 := new Flow(2000, f7_mass_frac, 500);
   
   var m1 := new Mixer;
   
   var f4 := m1.calculate(|f1, f2, f3|);
   
   var he1 := new HeatExchanger;
   var he2 := new HeatExchanger;
   var he3 := new HeatExchanger;
   
   var sp := new Splitter(|0.3, 0.3, 0.3|);
   var flows := sp.calculate(f7);
   var (f8, f9, f10) := (flows[0], flows[1], flows[2]);
   
   var (f11, f5) := he1.calculate(f8, f4);
   var (f12, f6) := he2.calculate(f9, f5);
   var (f13, f15) := he3.calculate(f10, f6);
   
   var m2 := new Mixer;
   var f14 := m2.calculate(|f11, f12, f13|);
   
   f14.temperature.Print;
   f15.temperature.Println
 end;
    
 begin
   foreach var g in range(2500, 2000, -50) do
     main(g)
 end.